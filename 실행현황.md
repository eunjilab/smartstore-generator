# 스마트스토어 자동생성앱 실행현황

## 프로젝트 개요
상품 사진을 업로드하면 Gemini AI가 분석하여 스마트스토어 상세페이지용 문구를 자동 생성하는 웹앱

## 기술 스택
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- Gemini API (gemini-2.0-flash)
- React Dropzone

---

## 완료된 작업

### 2026-02-12 (1차 개발)

#### 1. 프로젝트 초기 설정
- [x] Next.js 프로젝트 생성
- [x] TypeScript 설정
- [x] Tailwind CSS 설정
- [x] 필요한 패키지 설치 (react-dropzone, @google/generative-ai)

#### 2. 이미지 업로드 컴포넌트 (ImageUploader.tsx)
- [x] 드래그앤드롭 업로드
- [x] 클릭하여 파일 선택
- [x] 최대 10장 제한
- [x] 이미지 미리보기
- [x] 이미지 삭제 기능
- [x] 드래그로 순서 변경
- [x] 이미지 타입 지정 (대표/착장/디테일)

#### 3. 상품 정보 입력 폼 (ProductForm.tsx)
- [x] 성별 선택 (여성/남성)
- [x] 특이사항 입력
- [x] 사이즈 입력
- [x] 컬러 입력

#### 4. Gemini API 연동 (api/generate/route.ts)
- [x] 이미지 + 상품정보 받아서 처리
- [x] 여성용 프롬프트 (아엔 컬렉션 스타일)
- [x] 남성용 프롬프트
- [x] JSON 형식 응답 파싱
- [x] 에러 핸들링

#### 5. 결과 표시 UI (ResultDisplay.tsx)
- [x] 후킹 카피 + 사이즈/컬러 정보
- [x] 핵심 셀링포인트 3가지
- [x] 착장 사진 사이 문구 6개
- [x] 섹션별 복사 버튼
- [x] 전체 복사 버튼

#### 6. 메인 페이지 (page.tsx)
- [x] 4단계 UI (이미지 → 정보입력 → 생성 → 결과)
- [x] 로딩 상태 표시
- [x] 에러 메시지 표시

#### 7. 환경변수 설정 (.env.local)
- [x] GEMINI_API_KEY
- [x] NAVER_COMMERCE_APP_ID
- [x] NAVER_COMMERCE_APP_SECRET

### 2026-02-12 (2단계 개발)

#### 8. 이미지 비율 자동 처리 (utils/imageUtils.ts)
- [x] 대표이미지 1:1 비율 중앙 크롭 (cropToSquare)
- [x] 착장/디테일 이미지 3:4 비율 크롭 (cropTo3x4)
- [x] 모든 이미지 일괄 처리 (processImages)

#### 9. 상세페이지 HTML 템플릿 생성 (utils/htmlTemplate.ts)
- [x] 대표이미지 + 후킹문구 섹션
- [x] 셀링포인트 3가지 섹션
- [x] 착장사진 + 착장문구 섹션 (최대 6개)
- [x] 디테일컷 그리드 섹션
- [x] 모바일 최적화 스타일 (max-width: 750px)
- [x] 폰트 사이즈: 28pt/22pt/20pt/14pt

#### 10. HTML 미리보기 컴포넌트 (HTMLPreview.tsx)
- [x] 미리보기/코드 탭 전환
- [x] 모바일 미리보기 (375px iframe)
- [x] HTML 코드 복사 버튼
- [x] HTML 파일 다운로드 버튼
- [x] 모달 닫기 기능

#### 11. 메인 페이지 HTML 생성 기능 추가
- [x] "상세페이지 HTML 생성" 버튼
- [x] 이미지 크롭 상태 관리
- [x] HTML 미리보기 모달 연동

### 2026-02-12 (3단계 개발)

#### 12. 네이버 커머스 API 유틸리티 (utils/naverCommerce.ts)
- [x] OAuth 토큰 발급 (getAccessToken)
- [x] 토큰 자동 캐싱 및 갱신
- [x] 이미지 업로드 API (uploadImage)
- [x] 카테고리 조회 API (getCategories)
- [x] 상품 등록 API (registerProduct)
- [x] 카테고리 추천 함수 (suggestCategory)

#### 13. API 엔드포인트 (api/naver/)
- [x] /api/naver/upload - 이미지 업로드
- [x] /api/naver/register - 상품 등록
- [x] /api/naver/categories - 카테고리 조회/추천

#### 14. 판매 정보 입력 폼 (SalesInfoForm.tsx)
- [x] 상품명 입력 (AI 추천 자동 적용)
- [x] 카테고리 선택 (인기 카테고리 목록)
- [x] 판매가/재고수량 입력
- [x] 배송비 설정 (무료/유료/조건부무료)
- [x] 사이즈 옵션 선택 (자동 파싱)
- [x] 컬러 옵션 선택 (자동 파싱)

#### 15. 메인 페이지 네이버 등록 기능 추가
- [x] "스마트스토어에 상품 등록하기" 버튼
- [x] 이미지 업로드 → 상품 등록 순차 처리
- [x] 등록 결과 표시 (성공/실패)
- [x] 상품 ID 표시

### 2026-02-12 (4단계 개발)

#### 16. 최종 확인 요약 화면 (RegistrationSummary.tsx)
- [x] 등록될 이미지 미리보기 (대표이미지 표시)
- [x] 기본 정보 요약 (상품명, 카테고리, 판매가, 재고, 배송비)
- [x] 옵션 정보 요약 (사이즈, 컬러)
- [x] 생성된 문구 요약 (후킹카피, 셀링포인트)
- [x] 등록 전 확인사항 안내
- [x] "수정하기" / "스마트스토어에 등록하기" 버튼

#### 17. 등록 진행 프로그레스 (RegistrationProgress.tsx)
- [x] 4단계 진행 표시 (준비 → 이미지 업로드 → HTML 생성 → 상품 등록)
- [x] 프로그레스 바 (0-100%)
- [x] 현재 단계 메시지 표시
- [x] 완료/실패 상태 표시
- [x] 에러 메시지 표시

#### 18. 등록 완료/실패 화면 (RegistrationComplete.tsx)
- [x] 성공 시: 완료 아이콘 + 상품 정보
- [x] 성공 시: "판매자센터에서 확인하기" 링크
- [x] 성공 시: "상품 페이지 보기" 링크
- [x] 성공 시: "새 상품 등록하기" 버튼
- [x] 실패 시: 에러 메시지 + 해결 방법 안내
- [x] 실패 시: "다시 시도하기" 버튼

#### 19. 메인 페이지 최종 등록 흐름 구현
- [x] 앱 단계 상태 관리 (input → result → confirm → registering → complete)
- [x] 등록 진행 상태 관리 (preparing → uploading → generating → registering → completed/failed)
- [x] 프로그레스 업데이트 (단계별 %)
- [x] "등록 정보 확인하기" 버튼 (confirm 화면으로 이동)
- [x] "새 상품 등록하기" 버튼 (모든 상태 초기화)
- [x] "다시 시도" 버튼 (confirm 화면으로 복귀)

### 2026-02-12 (6단계 - 프롬프트 관리)

#### 21. 프롬프트 관리 기능 (PromptManager.tsx)
- [x] 헤더에 "프롬프트 관리" 버튼 추가
- [x] 남성용/여성용 프롬프트 탭 전환
- [x] 줄번호가 있는 텍스트 에디터
- [x] 프롬프트 수정 및 저장 (로컬 스토리지)
- [x] "기본값으로 되돌리기" 버튼
- [x] 변경사항 있음 표시 / 저장됨 피드백

#### 22. 프롬프트 상수 파일 (constants/prompts.ts)
- [x] 기본 여성용 프롬프트 (DEFAULT_FEMALE_PROMPT)
- [x] 기본 남성용 프롬프트 (DEFAULT_MALE_PROMPT)
- [x] 로컬 스토리지 저장/불러오기 유틸리티
- [x] 변수 치환 함수 ({{features}}, {{size}}, {{colors}})

#### 23. API 연동 수정
- [x] 커스텀 프롬프트 파라미터 추가 (customPrompt)
- [x] 저장된 프롬프트가 있으면 사용, 없으면 기본값 사용

---

## 파일 구조

```
스마트스토어_자동생성앱/
├── src/
│   ├── app/
│   │   ├── api/
│   │   │   ├── generate/
│   │   │   │   └── route.ts          # Gemini API 엔드포인트
│   │   │   └── naver/                # 네이버 커머스 API (3단계)
│   │   │       ├── upload/route.ts   # 이미지 업로드
│   │   │       ├── register/route.ts # 상품 등록
│   │   │       └── categories/route.ts # 카테고리 조회
│   │   ├── globals.css               # 전역 스타일
│   │   ├── layout.tsx                # 레이아웃
│   │   └── page.tsx                  # 메인 페이지
│   ├── components/
│   │   ├── ImageUploader.tsx         # 이미지 업로드 컴포넌트
│   │   ├── ProductForm.tsx           # 상품 정보 폼
│   │   ├── ResultDisplay.tsx         # 결과 표시 컴포넌트
│   │   ├── HTMLPreview.tsx           # HTML 미리보기 모달 (2단계)
│   │   ├── SalesInfoForm.tsx         # 판매 정보 폼 (3단계)
│   │   ├── RegistrationSummary.tsx   # 최종 확인 화면 (4단계)
│   │   ├── RegistrationProgress.tsx  # 등록 진행 표시 (4단계)
│   │   ├── RegistrationComplete.tsx  # 등록 완료/실패 (4단계)
│   │   └── PromptManager.tsx         # 프롬프트 관리 모달 (6단계)
│   ├── constants/
│   │   └── prompts.ts                # 기본 프롬프트 상수 (6단계)
│   └── utils/
│       ├── imageUtils.ts             # 이미지 크롭 유틸리티 (2단계)
│       ├── htmlTemplate.ts           # HTML 템플릿 생성 (2단계)
│       └── naverCommerce.ts          # 네이버 커머스 API (3단계)
├── .env.local                        # 환경변수 (API 키)
├── .gitignore
├── next.config.js
├── package.json
├── postcss.config.js
├── tailwind.config.ts
├── tsconfig.json
└── 실행현황.md                       # 이 파일
```

---

## 실행 방법

```bash
cd 스마트스토어_자동생성앱
npm run dev
# http://localhost:3000 에서 확인
```

---

## 프롬프트 특징

### 여성용 (아엔 컬렉션 스타일)
- 타겟: 20~30대 여성, 러블리/캐주얼
- 톤앤매너: "친한 언니가 찐으로 추천해주는 느낌"
- MZ 키워드 활용: "이거 뭐야", "핏 실화?", "이거 못 참지"
- 체형 어필 표현 포함

### 남성용
- 타겟: 20~30대 남성, 캐주얼/미니멀
- 톤앤매너: 담백하고 쿨한 느낌
- 과장 없이 핵심만

---

## 출력 형식

```json
{
  "hookingCopy": "후킹 카피 (10~20자)",
  "sizeColorInfo": "사이즈 + 컬러 정보",
  "sellingPoints": [
    {"title": "제목1", "description": "설명1"},
    {"title": "제목2", "description": "설명2"},
    {"title": "제목3", "description": "설명3"}
  ],
  "outfitCaptions": ["문구1", "문구2", "문구3", "문구4", "문구5", "문구6"]
}
```

---

### 2026-02-12 (5단계 - 배포)

#### 20. Vercel 배포
- [x] Vercel CLI 로그인
- [x] 프로젝트 연결 및 배포
- [x] 환경변수 설정 (GEMINI_API_KEY, NAVER_COMMERCE_APP_ID, NAVER_COMMERCE_APP_SECRET)
- [x] Production 배포 완료

---

## 배포 정보

| 항목 | 정보 |
|------|------|
| 프로덕션 URL | https://smartstore-generator.vercel.app |
| GitHub | https://github.com/eunjilab/smartstore-generator |
| Vercel 프로젝트 | smartstore-generator |
| 팀/계정 | shineunjis-projects-df4938aa |

### 재배포 방법 (GitHub 연동 - 자동배포)
```bash
git add .
git commit -m "변경내용"
git push origin main
# → Vercel이 자동으로 빌드 & 배포
```

### 수동 배포 방법
```bash
cd 스마트스토어_자동생성앱
npx vercel --prod
```

---

### 2026-02-12 (7단계 - 상세페이지 구조 업데이트)

#### 24. 이미지 업로드 영역 재설계 (ImageUploader.tsx)
- [x] 메인대표사진 업로드 영역 (1:1 비율)
- [x] 사이즈표 이미지 업로드 영역 (원본 비율 유지)
- [x] 컬러별 코디컷 관리 UI
  - [x] 컬러 추가/삭제 버튼
  - [x] 컬러명 드롭다운 (블랙, 화이트, 아이보리 등 10가지 프리셋)
  - [x] 직접입력 옵션
  - [x] 대표컬러 지정 체크박스
  - [x] 컬러별 여러 이미지 업로드

#### 25. 결과물 HTML 구조 변경 (htmlTemplate.ts)
- [x] 순서 변경: 후킹문구 → 메인사진 → 사이즈표 → 셀링포인트 → 컬러표시 → 코디컷
- [x] 대표컬러 표시 섹션 추가 (● 채움/○ 빈원 스타일)
- [x] 사이즈표 이미지 섹션 추가
- [x] 컬러 정보 전달 기능

#### 26. AI 프롬프트 수정 (prompts.ts)
- [x] 착장 문구 개수 동적 처리 ({{outfitImageCount}} 변수)
- [x] 코디컷 이미지 개수에 맞춰 문구 생성

#### 27. 데이터 구조 변경 (page.tsx)
- [x] ImageData 인터페이스 추가 (mainImage, sizeChartImage, colorOutfits)
- [x] ColorOutfit 인터페이스 추가 (id, colorName, isMain, images)
- [x] handleGenerate 함수 업데이트
- [x] handleGenerateHTML 함수에 컬러 정보 전달

### 2026-02-12 (8단계 - API 인증 수정)

#### 28. 네이버 커머스 API 인증 방식 수정 (naverCommerce.ts)
- [x] HMAC-SHA256에서 bcrypt로 서명 방식 변경
- [x] bcryptjs 패키지 설치
- [x] generateSignature 함수 bcrypt 적용
- [x] clientId_timestamp 형식으로 password 생성
- [x] clientSecret을 salt로 사용하여 bcrypt 해시 생성

### 2026-02-13 (Claude Code 규칙 강화)

#### 33. CLAUDE.md 규칙 추가
- [x] 서버/프로세스 절대 금지 규칙 추가 (kill, pkill, killall 임의 실행 금지)
- [x] "안 할게요" 약속 규칙 추가 (약속 시 반드시 CLAUDE.md에 기록)

#### 34. kill 명령어 차단 훅 설정
- [x] `~/.claude/settings.json`에 PreToolUse 훅 추가
- [x] `~/.claude/hooks/block-kill.sh` 스크립트 생성
- [x] kill/pkill/killall 명령어 실행 시 자동 차단

#### 35. 개발 서버 실행 방식 변경
- [x] nohup으로 서버 실행 (Claude Code 종료해도 서버 유지)
- [x] 실행 명령어: `cd ~/스마트스토어_자동생성앱 && nohup npm run dev > /dev/null 2>&1 &`

---

### 2026-02-13 (환경설정 오류 수정)

#### 29. Gemini API 키 교체
- [x] 기존 API 키가 유출되어 Google에서 차단됨
- [x] 새 API 키로 교체: `AIzaSyDe7eSeUKIoaLZhK_6qFIAQlKRIV6omW0c`

#### 30. 네이버 커머스 API "Invalid salt version" 오류 해결
- [x] **원인**: .env.local에서 `$` 문자가 환경변수 참조로 해석됨
- [x] **증상**: `$2a$04$...` 값이 `04.s...`로 잘못 읽힘
- [x] **해결**: `$`를 `\$`로 이스케이프 처리
  ```
  NAVER_COMMERCE_APP_SECRET=\$2a\$04\$jsy.s6tFg/kIguFtZmpXju
  ```
- [x] bcrypt 서명 생성 테스트 성공 확인

#### 31. Claude Code 훅 설정 수정
- [x] settings.json에서 존재하지 않는 훅 파일 참조 제거
- [x] auto-record.sh 훅을 범용(universal)으로 수정
- [x] 모든 프로젝트에서 실행현황.md 자동 감지하도록 개선

#### 32. 상품 등록 오류 수정
- [x] **오류**: "택배사를 필수로 입력해야 합니다"
- [x] **해결**: `deliveryInfo`에 `deliveryCompany: 'CJGLS'` 추가 (CJ대한통운)

---

## 다음 할 일 (예정)

- [ ] 생성된 문구 직접 수정 기능
- [ ] 히스토리 저장 기능
- [ ] 미리보기에서 다른 컬러 탭 전환 기능

## 완료된 추가 기능

- [x] 상세페이지 HTML 생성 기능 (2단계)
- [x] 이미지 비율 자동 처리 (1:1, 3:4)
- [x] HTML 미리보기 및 다운로드
- [x] 네이버 커머스 API 연동 (3단계)
- [x] 스마트스토어 상품 자동 등록
- [x] 판매 정보 입력 폼 (가격, 재고, 배송비, 옵션)
- [x] 최종 확인 요약 화면 (4단계)
- [x] 등록 진행 프로그레스 바
- [x] 등록 완료/실패 화면
- [x] "새 상품 등록" 버튼
- [x] Vercel 배포 완료 (5단계)
- [x] 프롬프트 관리 기능 (6단계)
- [x] 남성용/여성용 프롬프트 수정
- [x] 로컬 스토리지 저장 및 복원

---

## API 키 정보

| 항목 | 위치 |
|------|------|
| Gemini API | .env.local |
| 네이버 커머스 API | .env.local |

⚠️ .env.local 파일은 절대 공유하지 마세요!
