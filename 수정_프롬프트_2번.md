# 디테일컷 자동 생성 기능 추가해줘

## 결과물 순서 (최종)

```
1. 후킹문구
2. 메인대표사진
3. 사이즈표
4. 셀링포인트 3가지
5. 대표컬러 표시
6. 대표컬러의 사진코디컷 여러개 (중간중간 문구)
7. 디테일 정보 (텍스트)
8. 상세디테일컷 (이미지 + 설명) ← 신규
```

---

## 7. 디테일 정보 (텍스트) - 기존 유지

```
─────────────────────────
     DETAIL
─────────────────────────

소재 — 아크릴 혼방 니트, 소프트한 터치감
핏 — 내추럴 핏, 어깨선 따라 자연스럽게
디테일 — 골지 패턴, 립 마감 처리
기타 — 단독 세탁 권장

─────────────────────────
```

- "DETAIL" 타이틀 (24pt / 굵게)
- 소재 / 핏 / 디테일 / 기타 항목별 한 줄씩 (14pt / 보통)
- 전문적이면서 간결하게

---

## 8. 상세디테일컷 (신규)

### 구조

```
┌─────────────────────────────────────┐
│         DETAIL                      │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────┐  디테일 설명 1         │
│  │ 확대컷1  │  "골지 패턴의 짜임이   │
│  │         │   균일하게 표현됩니다"  │
│  └─────────┘                        │
│                                     │
│  ┌─────────┐  디테일 설명 2         │
│  │ 확대컷2  │  "립 마감 처리로       │
│  │         │   깔끔한 마무리"       │
│  └─────────┘                        │
│                                     │
│  ┌─────────┐  디테일 설명 3         │
│  │ 확대컷3  │  "부드러운 터치감의    │
│  │         │   고밀도 니트 원단"    │
│  └─────────┘                        │
│                                     │
└─────────────────────────────────────┘
```

### 디테일컷 항목 (3~5개)
- 소재 디테일 (원단 클로즈업)
- 봉제 디테일 (마감 처리)
- 포인트 디테일 (버튼, 지퍼, 포켓 등)
- 핏 디테일 (실루엣 강조)
- 기타 디테일 (라벨, 안감 등)

---

## 이미지 업로드 영역에 추가

```
┌─────────────────────────────────────────────────────────┐
│  이미지 업로드                                           │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📷 메인대표사진 (1:1 비율)                              │
│  [이미지 드롭 영역]                                      │
│                                                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📏 사이즈표 이미지                                      │
│  [이미지 드롭 영역]                                      │
│                                                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  🎨 컬러별 코디컷                                        │
│  [컬러 추가 UI...]                                      │
│                                                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  🔍 디테일컷 (선택)                                      │
│                                                         │
│  ☑️ AI 자동 생성 (이미지 미업로드 시)                    │
│                                                         │
│  [이미지1] [이미지2] [이미지3] [+ 추가]                  │
│                                                         │
│  * 이미지 미업로드 시 AI가 코디컷에서 자동 생성          │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## AI 자동 디테일컷 생성 로직

### 동작 조건
- 사용자가 디테일컷 이미지를 업로드하지 않은 경우
- "AI 자동 생성" 체크박스가 활성화된 경우

### 생성 프로세스

```
1. AI가 상품 분석
   ↓
2. 디테일 포인트 3~5개 선정
   (예: 소재, 봉제, 버튼, 핏, 라벨)
   ↓
3. 코디컷 이미지들 중에서 해당 부분 찾기
   ↓
4. 해당 부분 자동 크롭 & 확대
   ↓
5. 디테일컷 이미지 생성 완료
```

### AI 분석 항목

AI가 코디컷 이미지를 분석해서 다음 부분을 자동 감지:

| 디테일 종류 | 감지 대상 | 크롭 영역 |
|------------|----------|----------|
| 소재 | 원단 텍스처가 잘 보이는 부분 | 해당 영역 확대 |
| 봉제 | 목, 소매, 밑단 마감 부분 | 해당 영역 확대 |
| 포인트 | 버튼, 지퍼, 포켓, 자수 등 | 해당 영역 확대 |
| 핏 | 어깨선, 허리선, 실루엣 | 해당 영역 확대 |
| 라벨 | 브랜드 라벨, 케어 라벨 | 해당 영역 확대 |

### 크롭 & 확대 규칙

- 원본 이미지에서 해당 부분 좌표 추출
- 1:1 또는 4:3 비율로 크롭
- 해상도 유지하면서 확대
- 중앙 정렬

---

## AI 프롬프트에 추가할 내용

### 디테일컷 분석 프롬프트 (Gemini API)

```
이 상품 이미지들을 분석해서 디테일컷으로 보여줄 부분을 찾아줘.

## 찾아야 할 디테일 (3~5개)
1. 소재 디테일 - 원단 텍스처가 가장 잘 보이는 부분
2. 봉제 디테일 - 목, 소매, 밑단 등 마감 처리 부분
3. 포인트 디테일 - 버튼, 지퍼, 포켓, 자수 등 특징적인 부분
4. 핏 디테일 - 어깨선, 허리선 등 실루엣이 잘 보이는 부분
5. 기타 디테일 - 라벨, 안감 등

## 출력 형식 (JSON)

{
  "detailCuts": [
    {
      "type": "소재",
      "imageIndex": 0,
      "cropArea": { "x": 100, "y": 200, "width": 300, "height": 300 },
      "description": "고밀도 니트 원단의 균일한 짜임을 자랑합니다."
    },
    {
      "type": "봉제",
      "imageIndex": 1,
      "cropArea": { "x": 150, "y": 50, "width": 250, "height": 250 },
      "description": "목 부분 립 마감으로 깔끔한 라인을 연출합니다."
    },
    {
      "type": "핏",
      "imageIndex": 2,
      "cropArea": { "x": 80, "y": 100, "width": 400, "height": 400 },
      "description": "어깨선을 따라 내추럴하게 떨어지는 실루엣입니다."
    }
  ]
}

## 규칙
- 각 디테일별로 가장 잘 보이는 이미지와 영역 선택
- cropArea는 픽셀 단위 좌표
- description은 ~합니다 체로, 고급스러운 단어 사용
```

---

## 결과물 JSON 형식 (수정)

```json
{
  "productName": "상품명",
  "hookingCopy": "후킹 카피",
  "sizeColor": "사이즈 | 컬러 정보",
  "sellingPoints": [...],
  "outfitCopies": [...],
  "detail": {
    "material": "소재 정보",
    "fit": "핏 정보",
    "detail": "디테일 정보",
    "etc": "기타 정보"
  },
  "detailCuts": [
    {
      "type": "소재",
      "imageIndex": 0,
      "cropArea": { "x": 100, "y": 200, "width": 300, "height": 300 },
      "description": "고밀도 니트 원단의 균일한 짜임을 자랑합니다."
    },
    {
      "type": "봉제",
      "imageIndex": 1,
      "cropArea": { "x": 150, "y": 50, "width": 250, "height": 250 },
      "description": "목 부분 립 마감으로 깔끔한 라인을 연출합니다."
    },
    {
      "type": "핏",
      "imageIndex": 2,
      "cropArea": { "x": 80, "y": 100, "width": 400, "height": 400 },
      "description": "어깨선을 따라 내추럴하게 떨어지는 실루엣입니다."
    }
  ]
}
```

---

## 상세페이지 HTML (디테일 부분)

```html
<!-- 7. 디테일 정보 (텍스트) -->
<div class="detail-info">
  <h2>DETAIL</h2>
  <p>소재 — 아크릴 혼방 니트, 소프트한 터치감</p>
  <p>핏 — 내추럴 핏, 어깨선 따라 자연스럽게</p>
  <p>디테일 — 골지 패턴, 립 마감 처리</p>
  <p>기타 — 단독 세탁 권장</p>
</div>

<!-- 8. 상세디테일컷 (이미지 + 설명) -->
<div class="detail-cuts">
  <h2>DETAIL</h2>
  
  <div class="detail-cut-item">
    <img src="디테일컷1.jpg" />
    <p>고밀도 니트 원단의 균일한 짜임을 자랑합니다.</p>
  </div>
  
  <div class="detail-cut-item">
    <img src="디테일컷2.jpg" />
    <p>목 부분 립 마감으로 깔끔한 라인을 연출합니다.</p>
  </div>
  
  <div class="detail-cut-item">
    <img src="디테일컷3.jpg" />
    <p>어깨선을 따라 내추럴하게 떨어지는 실루엣입니다.</p>
  </div>
</div>
```

---

## 기술 참고

### 이미지 크롭 처리
```javascript
// AI가 반환한 cropArea 기반으로 이미지 크롭
async function cropDetailImage(imageFile, cropArea) {
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  
  // 1:1 비율로 설정
  const size = Math.max(cropArea.width, cropArea.height);
  canvas.width = size;
  canvas.height = size;
  
  // 이미지 로드 후 크롭 영역 그리기
  const img = await loadImage(imageFile);
  ctx.drawImage(
    img,
    cropArea.x, cropArea.y, cropArea.width, cropArea.height,
    0, 0, size, size
  );
  
  return canvas.toDataURL('image/jpeg');
}
```

### 처리 흐름
1. 사용자가 디테일컷 미업로드 + AI 자동 생성 체크
2. Gemini API에 코디컷 이미지들 전송
3. AI가 디테일 포인트 + 크롭 영역 반환
4. 클라이언트에서 이미지 크롭 처리
5. 크롭된 이미지 + 설명 텍스트로 디테일컷 섹션 생성